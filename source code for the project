	#include <iostream>
	#include <cstdlib>
	#include <iomanip>
	#include <windows.h>
	using namespace std;
	int id=10;
	void Menu(){
		cout<<"+ + + + + + + + + + + + + +"<<endl;
		cout<<"+ What do you want to do? +"<<endl;
		cout<<"+ 1. Update drug store    +"<<endl;
		cout<<"+ 2. View drug store      +"<<endl;
	    cout<<"+ 3. View drug stack      +"<<endl;
	    cout<<"+ 4. Clear Expired drugs  +"<<endl;
	    cout<<"+     and See Warnings    +"<<endl;
	    cout<<"+ 5. Daily total sales    +"<<endl;
	    cout<<"+ 6. Back to Main Menu    +"<<endl;
		cout<<"+ 7. Exit                 +"<<endl;
		cout<<"+ + + + + + + + + + + + + +"<<endl;
	}
	
	
	/*void Menu(){
		cout<<"+ + + + + + + + + + + + + +"<<endl;
		cout<<"+ What do you want to do? +"<<endl;
		cout<<"+ 1. Update drug store    +"<<endl;
		cout<<"+ 2. View drug store      +"<<endl;
	    cout<<"+ 3. View drug stack      +"<<endl;
	    cout<<"+ 4. Back to Main Menu    +"<<endl;
		cout<<"+ 5. Exit                 +"<<endl;
		cout<<"+ + + + + + + + + + + + + +"<<endl;
	} */
	void customMenu(){
		cout<<"+ + + + + + + + + + + + + + + +"<<endl;
		cout<<"+ What do you want to do?     +"<<endl;
		cout<<"+ 1. View drug store          +"<<endl;
		cout<<"+ 2. View drug availability   +"<<endl;
	    cout<<"+ 3. Place Order              +"<<endl;
	    cout<<"+ 4. Back to Main Menu        +"<<endl;
	    cout<<"+ 5. Exit                     +"<<endl;
		cout<<"+ + + + + + + + + + + + + + + +"<<endl;
	}
			
		
	struct Date{
	    int dd,mm,yy;
	};
	
	struct medicine_types{
	int ID,quantity,number_of_sold;
	float price,cost_of_each_drug;
	string name;
	Date Manufacture_date,Expiry_date;
	string type;

};

struct Total_sales_store{
	medicine_types sales_list;
	float total_sale;
}Med_sales[500];
	
	medicine_types Disposed_Med[500]; //universal structure to store expired drugs
	
	//Function declarations
	void setZero(medicine_types Zero[],int n);
	void Store_Drug (medicine_types med[]);
	void View_store(medicine_types stored[]);
	void check_stack(medicine_types Med_stack[]);
	void main_menu(medicine_types store[]);
	void admin_menu(medicine_types store[]);
	void customer_menu(medicine_types store[]);
	void place_order(medicine_types store[]);
	void Expiry_Notification_Indicator(medicine_types Medicines[]);
	void Drug_Disposal(medicine_types store[]);
	void Total_sales_table(medicine_types store[]);
	
	
	int main(){ 
	    //cout<<"---------------------------------------"<<endl;
	    //cout<<"Welcome to Our medical store Program"<<endl;
	    //cout<<"---------------------------------------"<<endl;
	    setprecision(3);
	    medicine_types store[100]={{1,10,0,12,11,"paracetamol",12,12,2200,11,11,2022,"antibiotic"},{2,10,0,12,11,"paracetamol",10,12,2200,11,11,2020,"antibiotic"},
	{3,10,0,12,11,"paracetamol",12,12,2000,11,11,2020,"antibiotic"},{4,10,0,12,10.99,"paracetamol",12,12,2200,11,9,2021,"antibiotic"},
	{5,10,0,12,11,"paracetamol",12,12,2200,11,11,2209,"antibiotic"},{6,10,0,12,11,"paracetamol",12,12,2200,11,11,2019,"antibiotic"},
	{7,10,0,12,12,"paracetamol",12,12,2200,11,11,2209,"antibiotic"},{8,10,0,12,10,"paracetamol",12,12,2200,11,11,2209,"antibiotic"},
	{9,10,0,12,13,"paracetamol",12,12,2200,11,11,2209,"antibiotic"},{10,10,0,12,9,"paracetamol",12,12,2200,11,11,2209,"antibiotic"}};
	  for(int i=0;i<100;i++){
	  	store[i].number_of_sold=0;
	  } 
	    main_menu(store);
	
	   
	   return 0;
		
	}
	
	void main_menu(medicine_types store[])
	{
		cout<<"---------------------------------------"<<endl;
	    cout<<"Welcome to Our medical store Program   "<<endl;
	    cout<<"---------------------------------------"<<endl;
	    
	    int num;
	    do
	    {		
	        Expiry_Notification_Indicator(store); //function call to indicate existance of expired drug
			int count=0;
	        cout << "\n\n\n\tMAIN MENU";
	        cout << "\n\n\t01. CUSTOMER";
	        cout << "\n\n\t02. ADMINISTRATOR";
	        cout << "\n\n\t03. EXIT";
	        cout << "\n\n\tPlease Select Your Option (1-3) ";
	        cin>>num;
	        switch (num)
	        {
	        case 1:
	            customer_menu(store);
	            break;
	        case 2:
	        	cout<<"Enter password to log in you have 3 trials : ";
	        	backin :
	        	if(count<3){
	        	int p;
	        	cin>>p;
				if(p==123){
				cout<<"Welcome to admin menu!!";
	            admin_menu(store);}
	            else
	            	{cout<<"Incorrect password!!! try again\n";
	            	count++;
	            	goto backin;} }	
	            cout<<"We detected illegal access trial!!";
	            exit(0);
	            break;
	        case 3: cout<<"You choose to to exit the program"<<endl;
			        system("pause");
					exit(0);
	        default:
	            cout << "\a";
	        }
	    } while (num != '3');
	}
	
	void admin_menu(medicine_types store[])
	{   
		int choice;
	    do{
		Expiry_Notification_Indicator(store); //function call to indicate existance of expired drug
		system("pause");
	     system("cls");
	   	Menu();
	   	cout<<"Enter your choice here: "; cin>>choice;
	   	switch(choice){
	   		
	   		case 1: Store_Drug(store);
	    			system("pause");
	    			View_store(store);
	    			break;
	    	case 2: View_store(store);
	    			system("pause");
	    			break;
	    	case 3: check_stack(store);
	    			system("pause");
	    	        break;
	    	case 4: cout<<"cleared medicines!!!"<<endl;
					Drug_Disposal(store);
					cout<<"WELL done!!!"<<endl; break;
			case 5: Total_sales_table(store);
			        break;
	    	case 6: main_menu(store);
	    			system("pause");
	    	        break;
	    	default: cout<<"You choose to to exit the program"<<endl;
			        system("pause");
					exit(0);
		   }
	   	
	   }while(true);
	   
	}
	
	void customer_menu(medicine_types store[])
	{   
		int choice;
	    do{system("pause");
	     system("cls");
	   	customMenu();
	   	cout<<"Enter your choice here: "; cin>>choice;
	   	switch(choice){
	   		case 1: View_store(store);
	    			system("pause");
	    			break;
	    	case 2: check_stack(store);
	    			system("pause");
	    	        break;
	    	case 3: place_order(store);
	    	
	    			system("pause");
	    			
	    	        break;
	    	case 4: main_menu(store);
	    			system("pause");
	    	        break;
	    	default: cout<<"You choose to to exit the program"<<endl;
			        system("pause");
					exit(0);
		   }
	   	
	   }while(true);
	}
	
	void setZero(medicine_types Zero[],int n){
			for(int i=0;i<n;i){
			
			Zero[i].ID={0};
			Zero[i].quantity={0};
			Zero[i].price={0};
			Zero[i].name={""};
			Zero[i].Manufacture_date.dd={0};
			Zero[i].Manufacture_date.mm={0};
			Zero[i].Manufacture_date.yy={0};
		}
	}
	
	void check_stack(medicine_types Med_stack[]){
		cout<<"Do you want to see the total or partial stack for specific medicine?1/0:__";
		int stack_choice;
		cin>>stack_choice;
		if(stack_choice==1){
			cout.setf(ios_base::left);
			cout<<setw(6)<<"Drug ID"<<setw(15)<<"Name of Medicine"<<setw(10)<<"quantity"<<setw(10)<<"price"<<endl;
			for(int i=0;i<id;++i){
				cout<<setw(6)<<Med_stack[i].ID<<setw(18)<<Med_stack[i].name<<setw(13)<<Med_stack[i].quantity<<setw(15)<<Med_stack[i].price<<endl;
				
			}
		}
		
		else{ string Med_name;
			cout<<"Enter the name of the medicine you want to see:  "; cin>>Med_name;
			cout.setf(ios_base::left);
			cout<<setw(6)<<"Drug ID"<<setw(15)<<"Name of Medicine"<<setw(10)<<"quantity"<<setw(10)<<"price"<<endl;
			for(int k=0;k<=id;++k){
				if(Med_name==Med_stack[k].name){
					cout<<setw(6)<<Med_stack[k].ID<<setw(18)<<Med_stack[k].name<<setw(13)<<Med_stack[k].quantity<<setw(15)<<Med_stack[k].price<<endl;
				}
			}
			
		}
	}
	void Store_Drug (medicine_types med[]){
		int k,num_of_med;
		cout<<"Do you want to continue with the default stack or you want to enter from scratch?1/0"<<endl;
		cin>>k;
		cout<<"How many number of medicine you are going to store"<<endl;
		cin>>num_of_med;
		switch(k){
		
		case 1:	
		{
			cout<<"\n continued Enter the necessary informations for the drug you want to store!!!"<<endl;
			for(int i=0;i<num_of_med;++i){
			     //med[id].ID=id+1;
				cout<<"Drug ID: "; cin>>med[id].ID;
				cout<<"Enter Drug Name: "; cin>>med[id].name;
				cout<<"Enter the quantity of this medicine: "; cin>>med[id].quantity;
				cout<<"Enter Price: ";  cin>>med[id].price;
				cout<<"Enter Drug type(E.g Antibitic,Antiseptic,Disinfectant...): "; cin>>med[id].type;
				cout<<"Enter Manufactured Date: \n";
				cout<<"      Day: "; cin>>med[id].Manufacture_date.dd;
				cout<<"      Month: "; cin>>med[id].Manufacture_date.mm;
				cout<<"      Year: "; cin>>med[id].Manufacture_date.yy;
				cout<<"Enter Expiry Date: \n";
				cout<<"      Day: "; cin>>med[id].Expiry_date.dd;
				cout<<"      Month: "; cin>>med[id].Expiry_date.mm;
				cout<<"      Year: "; cin>>med[id].Expiry_date.yy;
				id++; cout<<"\n";
			}
		} break;
		
		default:
		
		   {
		   
		   	for(int k=0;k<10;++k){
				med[k].ID={0};
				med[k].name={"0"};
				med[k].quantity={0};
				med[k].price={0};
			}
	    
		cout<<"\n Enter the necessary informations for the drug you want to store!!!"<<endl;
		
			for(int i=0;i<num_of_med;++i){
			    med[i].ID=i+1;
				cout<<"Drug ID: "<<med[i].ID<<endl;
				cout<<"Enter Drug Name: "; cin>>med[i].name;
				cout<<"Enter the quantity of this medicine: "; cin>>med[i].quantity;
				cout<<"Enter Price: ";  cin>>med[i].price;
				cout<<"Enter Drug type(E.g Antibitic,Antiseptic,Disinfectant...): "; cin>>med[i].type;
				cout<<"Enter Manufactured Date: \n";
				cout<<"      Day: "; cin>>med[i].Manufacture_date.dd;
				cout<<"      Month: "; cin>>med[i].Manufacture_date.mm;
				cout<<"      Year: "; cin>>med[i].Manufacture_date.yy;
				cout<<"Enter Expiry Date: \n";
				cout<<"      Day: "; cin>>med[i].Expiry_date.dd;
				cout<<"      Month: "; cin>>med[i].Expiry_date.mm;
				cout<<"      Year: "; cin>>med[i].Expiry_date.yy;
				id=med[i].ID;
			}	
			
		} break;
		
	}
		
	}
	
	void View_store(medicine_types stored[]){
		
	  cout<<"The database of the medicine in the store is as shown below"<<endl;
	  cout<<"-----------------------------------------------------------------"<<endl;
	  cout<<"-----------------------------------------------------------------"<<endl;
	  cout<<"Med.ID \t Med. Name \t   Quant.  Price \t Drug type \t Manufacure \t expiry date"<<endl;
	  cout<<"       \t           \t        \t       \t           \t   Date     \t           "<<endl;
	   			cout.setf(ios_base::left);
			for(int i=0;i<id;++i){
				if(stored[i].name!="0"){
			    cout<<stored[i].ID<<setw(1)<<"\t "<<stored[i].name<<setw(1)<<"\t   "<<stored[i].quantity<<setw(1)<<"\t  "<<stored[i].price<<setw(1)<<"\t\t "<<stored[i].type<<setw(1)<<"\t"
				    <<stored[i].Manufacture_date.dd<<"/"<<stored[i].Manufacture_date.mm<<"/"<<stored[i].Manufacture_date.yy
					<<"\t"<<stored[i].Expiry_date.dd<<"/"<<stored[i].Expiry_date.mm<<"/"<<stored[i].Expiry_date.yy<<endl;
		}
			}
		cout<<"-----------------------------------------------------------------"<<endl;
	    cout<<"-----------------------------------------------------------------"<<endl;
		
	} 
	
	void place_order(medicine_types store[])
	{
		
		int c=0,existance_check=0,order_arr[c];int quan[50],s;
	    float amt, damt, total = 0;
	    char ch = 'Y';
	    View_store(store);
	    cout << "\n============================";
	    cout << "\n PLACE YOUR ORDER";
	    cout << "\n============================\n";
	    
	    do
	    {   label1:
	        cout << "\n\nEnter The ID No. Of The Medicene : ";
	        cin >>order_arr[c];//order_arr  //Med_sales[c].sales_list.ID;
	        for(int i=0;i<id;i++){
	         if(order_arr[c]==store[i].ID){
	         	 label2: s=i;
	         	 existance_check++;
		        cout << "\nQuantity in number : ";
		        cin>>quan[c];
		        if(quan[c]>store[i].quantity){
		        	cout<<"Beyond the amount in the store please enter again!!!"<<endl;goto label2;
				}
		        store[i].number_of_sold+=quan[c];  //Med_sales[c].sales_list.quantity
		        store[i].quantity=store[i].quantity-quan[c];
		           }
		        
		 }   
		 
	     if(existance_check==0)
		 	{cout<<"Medicine with this ID is doesn't exist!!!"<<endl;
		           cout<<"Please enter again correctly"<<endl; goto label1;
	           }
		
	        c++;
	        cout << "\nDo You Want To Order Another Medicene ? (y/n)";
	        cin >> ch;
	        //Med_sales[c].sales_list=
	    } while (ch == 'y' || ch == 'Y');
	    cout << "\n\nThank You For Placing The Order";
	    system("pause");
	    system("cls");
	
	    cout << "\n\n******************************** PURCHASED ************************\n";
	    cout << "\nMed ID\tMd Name\tQuantity \tPrice \tAmount \n ";
	    
	    
	    
	    for(int i=0;i<c;i++)
	    {
	    	int x=0;
	    	int m=0;
	    	while(m<id)
	    	{
	    		if(store[x].ID == order_arr[i])
				{
					amt=store[x].price*quan[i];
					cout << "\n" << store[x].ID << "\t" << store[x].name<<
	                    "\t" << quan[i] << "\t" << store[x].price<< "\t" << amt;
	                total += amt;	
				}
				x++;
				m++;
			}
		}
		
		cout << "\n\n\t\t\t\tTOTAL = " << total<<endl;
		system("pause");
	    system("cls");
				 customer_menu(store);
	}
	
	void Expiry_Notification_Indicator(medicine_types Medicines[]){
		int n=0;
		SYSTEMTIME current_time;
		GetSystemTime (&current_time);
	    HANDLE font_color=GetStdHandle(STD_OUTPUT_HANDLE);
	    cout.setf(ios_base::left);
		for(int i=0;i<id;++i){
			if(current_time.wYear>Medicines[i].Expiry_date.yy){
				SetConsoleTextAttribute(font_color,4); n++;
	
			}
	
			else if(current_time.wYear==Medicines[i].Expiry_date.yy){
	
				if(current_time.wMonth>Medicines[i].Expiry_date.mm){
					SetConsoleTextAttribute(font_color,4); n++;
				cout<<Medicines[i].ID<<"\t"<<Medicines[i].name<<endl;
			    }
	
			    else if(current_time.wMonth==Medicines[i].Expiry_date.mm){
	
				    	if(current_time.wDay>=Medicines[i].Expiry_date.dd){
				    		SetConsoleTextAttribute(font_color,5); n++;
	
				    	}
	
	
				}
	
	
			}
	
	
	
		}
		if(n==0){
		    SetConsoleTextAttribute(font_color,7);
		}
	
	}
	
	void Drug_Disposal(medicine_types store[]){
		SYSTEMTIME current_time;
		GetSystemTime (&current_time);
		int m=0;
		for(int i=0;i<id;++i){
			if(current_time.wYear>store[i].Expiry_date.yy){
				Disposed_Med[m]=store[i]; m++;
				for(int k=i;k<id-1;k++){
					store[k]=store[k+1];
				} --i;	id--;
			}
			else if(current_time.wYear==store[i].Expiry_date.yy){
	
				if(current_time.wMonth>store[i].Expiry_date.mm){
					Disposed_Med[m]=store[i]; m++;
					for(int k=i;k<id-1;k++){
					store[k]=store[k+1];
				}--i; id--;
				}
				else if(current_time.wMonth==store[i].Expiry_date.mm){
					if(current_time.wDay>=store[i].Expiry_date.dd){
						Disposed_Med[m]=store[i]; m++;
						for(int k=i;k<id-1;k++){
						store[k]=store[k+1];
						}--i; id--;
					}
	
				}
	
			}
	
		}
	
		if(m!=0){
		cout<<"Drug ID \t Name \t quantity \t cost "<<endl;
		for(int j=0;j<m;j++){
			   cout<<Disposed_Med[j].ID<<"\t"<<Disposed_Med[j].name<<"\t"<<Disposed_Med[j].quantity<<"\t"<<Disposed_Med[j].cost_of_each_drug<<endl;
			}
	
		}
		
		else
		   cout<<"The expired drugs list is empity!!!"<<endl;
		   
		   for(int k=0;k<id;k++){
				store[k].ID=k+1;
				cout<<store[k].ID<<" ";
		}
		cout<<"The drug ID have been modified due the cleared drugs"<<endl<<endl;
	
	}
	
	void Total_sales_table(medicine_types store[]){
		
		cout<<"Te daily total sales summary is as shown below"<<endl<<endl;
		cout<<"---------------------------------------------------"<<endl;
		cout<<"---------------------------------------------------"<<endl;
		cout<<setw(8)<<"Med. ID"<<setw(15)<<"Med Name"<<setw(10)<<"Quant. of sold"<<setw(12)
		    <<"selling Price"<<setw(10)<<"Total sales in Birr"<<setw(5)<<endl;
		 for(int k=0;k<id;k++){
		 	if(store[k].number_of_sold!=0){
		 		cout<<setw(5)<<store[k].ID<<setw(20)<<store[k].name<<setw(13)<<store[k].number_of_sold
				    <<setw(15)<<store[k].price<<setw(15)<<(store[k].price)*(store[k].number_of_sold)<<endl;
			 }
		 	
		 }
		cout<<"---------------------------------------------------"<<endl;
		cout<<"---------------------------------------------------"<<endl;
	}
	
