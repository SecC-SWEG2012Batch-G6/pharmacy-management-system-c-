#include <iostream>
#include <cstdlib>
#include <iomanip>
using namespace std;
int id=10;
void Menu(){
	cout<<"+ + + + + + + + + + + + + +"<<endl;
	cout<<"+ What do you want to do? +"<<endl;
	cout<<"+ 1. Update drug store    +"<<endl;
	cout<<"+ 2. View drug store      +"<<endl;
        cout<<"+ 3. View drug stack      +"<<endl;
        cout<<"+ 4. Back to Main Menu    +"<<endl;
	cout<<"+ 5. View total sale      +"<<endl;
	cout<<"+ 6. Exit                 +"<<endl;
	cout<<"+ + + + + + + + + + + + + +"<<endl;
} 
void customMenu(){
	cout<<"+ + + + + + + + + + + + + +"<<endl;
	cout<<"+ What do you want to do? +"<<endl;
	cout<<"+ 1. View drug store      +"<<endl;
	cout<<"+ 2. View drug stack      +"<<endl;
        cout<<"+ 3. Place Order          +"<<endl;
        cout<<"+ 4. Back to Main Menu    +"<<endl;
        cout<<"+ 5. Exit                 +"<<endl;
	cout<<"+ + + + + + + + + + + + + +"<<endl;
}
		
	
struct Date{
    int dd,mm,yy;
};

struct medicine_types{
	int ID,quantity;
	float price;
	string name;
	Date Manufacture_date,Expiry_date;
	string type;
	
	
};
struct orderInfo{
	           int receiptNo;
	           char customName[];
	           Date orderdate;
	           medicine_types medicine;
	           }customer[100];
//Function declarations
void setZero(medicine_types Zero[],int n);
void Store_Drug (medicine_types med[]);
void View_store(medicine_types stored[]);
void check_stack(medicine_types Med_stack[]);
void main_menu(medicine_types store[]);
void admin_menu(medicine_types store[]);
void customer_menu(medicine_types store[]);
void place_order(medicine_types store[]);
void totalSale(orderInfo customer[], int n);


int main(){ 
    //cout<<"---------------------------------------"<<endl;
    //cout<<"Welcome to Our medical store Program"<<endl;
    //cout<<"---------------------------------------"<<endl;
    medicine_types store[100]={{1,10,12,"paracetamol",12,12,2200,11,11,2209,"antibiotic"},{2,10,12,"paracetamol",10,12,2200,11,11,2209,"antibiotic"},
	{3,10,12,"paracetamol",12,12,2200,11,11,2209,"antibiotic"},{4,10,12,"paracetamol",12,12,2200,11,11,2209,"antibiotic"},
	{5,10,12,"paracetamol",12,12,2200,11,11,2209,"antibiotic"},{6,10,12,"paracetamol",12,12,2200,11,11,2209,"antibiotic"},
	{7,10,12,"paracetamol",12,12,2200,11,11,2209,"antibiotic"},{8,10,12,"paracetamol",12,12,2200,11,11,2209,"antibiotic"},
	{9,10,12,"paracetamol",12,12,2200,11,11,2209,"antibiotic"},{10,10,12,"paracetamol",12,12,2200,11,11,2209,"antibiotic"}};
   
    main_menu(store);
   /*int num;
    do
    {
    	
    		
        int count=0;
        cout << "\n\n\n\tMAIN MENU";
        cout << "\n\n\t01. CUSTOMER";
        cout << "\n\n\t02. ADMINISTRATOR";
        cout << "\n\n\t03. EXIT";
        cout << "\n\n\tPlease Select Your Option (1-3) ";
        cin>>num;
        switch (num)
        {
        case 1:
            customer_menu(store);
            break;
        case 2:
        	cout<<"Enter password to log in you have 3 trials : ";
        	backin :
        	if(count<3){
        	int p;
        	cin>>p;
			if(p==123){
			cout<<"Welcome to admin menu!!";
            admin_menu(store);}
            else
            	{cout<<"Incorrect password!!! try again\n";
            	count++;
            	goto backin;} }	
            
            return 0;
            break;
        case 3:
            return 0 ;
        default:
            cout << "\a";
        }
    } while (num != '3');  */

   
   return 0;
	
}

void main_menu(medicine_types store[])
{
	cout<<"---------------------------------------"<<endl;
    cout<<"Welcome to Our medical store Program"<<endl;
    cout<<"---------------------------------------"<<endl;
    
    int num;
    do
    {		
        int count=0;
        cout << "\n\n\n\tMAIN MENU";
        cout << "\n\n\t01. CUSTOMER";
        cout << "\n\n\t02. ADMINISTRATOR";
        cout << "\n\n\t03. EXIT";
        cout << "\n\n\tPlease Select Your Option (1-3) ";
        cin>>num;
        switch (num)
        {
        case 1:
            customer_menu(store);
            break;
        case 2:
        	cout<<"Enter password to log in you have 3 trials : ";
        	backin :
        	if(count<3){
        	int p;
        	cin>>p;
			if(p==123){
			cout<<"Welcome to admin menu!!";
            admin_menu(store);}
            else
            	{cout<<"Incorrect password!!! try again\n";
            	count++;
            	goto backin;} }	
            cout<<"We detected illegal access trial!!";
            exit(0);
            break;
        case 3: cout<<"You choose to to exit the program"<<endl;
		        system("pause");
				exit(0);
        default:
            cout << "\a";
        }
    } while (num != '3');
}

void admin_menu(medicine_types store[])
{
	int choice;
    do{system("pause");
     system("cls");
   	Menu();
   	cout<<"Enter your choice here: "; cin>>choice;
   	switch(choice){
   		case 1: Store_Drug(store);
    			system("pause");
    			View_store(store);
    			break;
    	case 2: View_store(store);
    			system("pause");
    			break;
    	case 3: check_stack(store);
    			system("pause");
    	        break;
    	case 4: main_menu(store);
    			system("pause");
    	        break;
	case 5:totalSale(customer,100);
	                system("pause");
    	        break;
    	default: cout<<"You choose to to exit the program"<<endl;
		        system("pause");
				exit(0);
	   }
   	
   }while(true);
   
}

void customer_menu(medicine_types store[])
{
	int choice;
    do{system("pause");
     system("cls");
   	customMenu();
   	cout<<"Enter your choice here: "; cin>>choice;
   	switch(choice){
   		case 1: View_store(store);
    			system("pause");
    			break;
    	case 2: check_stack(store);
    			system("pause");
    	        break;
    	case 3: place_order(store);
    			system("pause");
    	        break;
    	case 4: main_menu(store);
    			system("pause");
    	        break;
    	default: cout<<"You choose to to exit the program"<<endl;
		        system("pause");
				exit(0);
	   }
   	
   }while(true);
}

void setZero(medicine_types Zero[],int n){
		for(int i=0;i<n;i){
		
		Zero[i].ID={0};
		Zero[i].quantity={0};
		Zero[i].price={0};
		Zero[i].name={""};
		Zero[i].Manufacture_date.dd={0};
		Zero[i].Manufacture_date.mm={0};
		Zero[i].Manufacture_date.yy={0};
	}
}

void check_stack(medicine_types Med_stack[]){
	cout<<"Do you want to see the total or partial stack for specific medicine?1/0:__";
	int stack_choice;
	cin>>stack_choice;
	if(stack_choice==1){
		cout.setf(ios_base::left);
		cout<<"Drug ID \t Name of Medicine \t quantity \t price"<<endl;
		for(int i=0;i<=id;++i){
			cout<<Med_stack[i].ID<<setw(7)<<Med_stack[i].name<<setw(7)<<Med_stack[i].quantity<<setw(8)<<Med_stack[i].price<<endl;
			
		}
	}
	
	else{ string Med_name;
		cout<<"Enter the name of the medicine you want to see:  "; cin>>Med_name;
		cout.setf(ios_base::left);
		cout<<"Drug ID \t Name of Medicine \t quantity \t price"<<endl;
		for(int k=0;k<=id;++k){
			if(Med_name==Med_stack[k].name){
				cout<<Med_stack[k].ID<<setw(7)<<Med_stack[k].name<<setw(7)<<Med_stack[k].quantity<<setw(8)<<Med_stack[k].price<<endl;
			}
		}
		
	}
}
void Store_Drug (medicine_types med[]){
	int k,num_of_med;
	cout<<"Do you want to continue with the default stack or you want to enter from scratch?1/0"<<endl;
	cin>>k;
	cout<<"How many number of medicine you are going to store"<<endl;
	cin>>num_of_med;
	switch(k){
	
	case 1:	
	{
		cout<<"\n continued Enter the necessary informations for the drug you want to store!!!"<<endl;
		for(int i=0;i<num_of_med;++i){
		     med[id].ID=id+1;
			cout<<"Drug ID: "<<med[id].ID<<endl;
			cout<<"Enter Drug Name: "; cin>>med[id].name;
			cout<<"Enter the quantity of this medicine: "; cin>>med[id].quantity;
			cout<<"Enter Price: ";  cin>>med[id].price;
			cout<<"Enter Drug type(E.g Antibitic,Antiseptic,Disinfectant...): "; cin>>med[id].type;
			cout<<"Enter Manufactured Date: \n";
			cout<<"      Day: "; cin>>med[id].Manufacture_date.dd;
			cout<<"      Month: "; cin>>med[id].Manufacture_date.mm;
			cout<<"      Year: "; cin>>med[id].Manufacture_date.yy;
			cout<<"Enter Expiry Date: \n";
			cout<<"      Day: "; cin>>med[id].Expiry_date.dd;
			cout<<"      Month: "; cin>>med[id].Expiry_date.mm;
			cout<<"      Year: "; cin>>med[id].Expiry_date.yy;
			id++; cout<<"\n";
		}
	} break;
	
	default:
	
	   {
	   
	   	for(int k=0;k<10;++k){
			med[k].ID={0};
			med[k].name={"0"};
			med[k].quantity={0};
			med[k].price={0};
		}
    // setZero(med[],10);
	cout<<"\n Enter the necessary informations for the drug you want to store!!!"<<endl;
	
		for(int i=0;i<num_of_med;++i){
		    med[i].ID=i+1;
			cout<<"Drug ID: "<<med[i].ID<<endl;
			cout<<"Enter Drug Name: "; cin>>med[i].name;
			cout<<"Enter the quantity of this medicine: "; cin>>med[i].quantity;
			cout<<"Enter Price: ";  cin>>med[i].price;
			cout<<"Enter Drug type(E.g Antibitic,Antiseptic,Disinfectant...): "; cin>>med[i].type;
			cout<<"Enter Manufactured Date: \n";
			cout<<"      Day: "; cin>>med[i].Manufacture_date.dd;
			cout<<"      Month: "; cin>>med[i].Manufacture_date.mm;
			cout<<"      Year: "; cin>>med[i].Manufacture_date.yy;
			cout<<"Enter Expiry Date: \n";
			cout<<"      Day: "; cin>>med[i].Expiry_date.dd;
			cout<<"      Month: "; cin>>med[i].Expiry_date.mm;
			cout<<"      Year: "; cin>>med[i].Expiry_date.yy;
			id=med[i].ID;
		}	
		
	} break;
	
}
	
}

void View_store(medicine_types stored[]){
	
  cout<<"The database of the medicine in the store is as shown below"<<endl;
  cout<<"-----------------------------------------------------------------"<<endl;
  cout<<"-----------------------------------------------------------------"<<endl;
  cout<<"Med.ID \t Med. Name \t   Quant.  Price \t Drug type \t Manufacure \t expiry date"<<endl;
  cout<<"       \t           \t        \t       \t           \t   Date     \t           "<<endl;
   			cout.setf(ios_base::left);
		for(int i=0;i<id;++i){
			if(stored[i].name!="0"){
		    cout<<stored[i].ID<<setw(1)<<"\t "<<stored[i].name<<setw(1)<<"\t   "<<stored[i].quantity<<setw(1)<<"\t  "<<stored[i].price<<setw(1)<<"\t\t "<<stored[i].type<<setw(1)<<"\t"
			    <<stored[i].Manufacture_date.dd<<"/"<<stored[i].Manufacture_date.mm<<"/"<<stored[i].Manufacture_date.yy
				<<"\t"<<stored[i].Expiry_date.dd<<"/"<<stored[i].Expiry_date.mm<<"/"<<stored[i].Expiry_date.yy<<endl;
	}
		}
	cout<<"-----------------------------------------------------------------"<<endl;
    cout<<"-----------------------------------------------------------------"<<endl;
	
} 

void place_order(medicine_types store[])
{
	
	int c=0,order_arr[c];int quan[50];
    float amt, damt, total = 0;
    char ch = 'Y';
    View_store(store);
    cout << "\n============================";
    cout << "\n PLACE YOUR ORDER";
    cout << "\n============================\n";
    
    do
    {
        cout << "\n\nEnter The ID No. Of The Medicene : ";
        cin >> order_arr[c];
        cout << "\nQuantity in number : ";
        cin >> quan[c];
        c++;
        cout << "\nDo You Want To Order Another Medicene ? (y/n)";
        cin >> ch;
    } while (ch == 'y' || ch == 'Y');
    cout << "\n\nThank You For Placing The Order";
    system("pause");
    system("cls");

    cout << "\n\n******************************** PURCHASED ************************\n";
    cout << "\nMed ID\tMd Name\tQuantity \tPrice \tAmount \n ";
    
    
    
    for(int i=0;i<c;i++)
    {
    	int x=0;
    	int m=0;
    	while(m<id)
    	{
    		if(store[x].ID == order_arr[i])
			{
				amt=store[x].price*quan[i];
				cout << "\n" << store[x].ID << "\t" << store[x].name<<
                    "\t" << quan[i] << "\t" << store[x].price<< "\t" << amt;
                total += amt;	
			}
			x++;
			m++;
		}
	}
	cout << "\n\n\t\t\t\tTOTAL = " << total<<endl;
	system("pause");
    system("cls");
			 customer_menu(store);
}

void totalSale(orderInfo customer[], int n){
  int m,i,j;
  float sale=0;
  float total_sale=0;
	cout<<"How Many orders are there today?"<<endl;
	cin>>n;
	if(n==0){
		cout<<"There are no orders today."<<endl;
	}
	else{
	for(i=0;i<n;i++){
		cout<<"Enter" <<i+1 <<" Customers Name:  ";
		cin>>customer[i].customName;
		cout<<"How many medicines did the customer ordered?"<<endl;
		cin>>m;
		for( j=0;j<m;j++){
		cout<<"\nEnter"<<j+1<< " Medicine  Id:  ";
		cin>>customer[j].medicine.ID;
		cout<<"\nEnter Medicine  Name:  ";
		cin>>customer[j].medicine.name;
		cout<<"\nEnter Medicine  Type:  ";
		cin>>customer[j].medicine.type;
		cout<<"Enter the price:  ";
		cin>>customer[j].medicine.price;
		cout<<"\nHow many of this madicine were ordered?  ";
		cin>>customer[j].medicine.quantity;

		sale+=(customer[j].medicine.quantity*customer[j].medicine.price);
		}
		cout<<"\nEnter receipt Number:  ";
		cin>>customer[i].receiptNo;

		cout<<"Enter Order Date dd/mm/yy:  ";
		cin>>customer[i].orderdate.dd;
		cin>>customer[i].orderdate.dd;
		cin>>customer[i].orderdate.dd;
		}
total_sale+=sale;
	}


	cout<<"Order Information"<<endl;
	cout<< "\t\t\tCUSTOMER NAME\t\tMEDICINE ID\t\tMEDICINE NAME\t\tMEDICINE TYPE\t\tPRICE\t\tQUANTITY\t\tRECEIPT NO\t\tORDER DATE\t\tTOLAL SALE PRICE OF EACH MEDICINE"<<endl;
	cout<<endl;
	cout<<"\t\t\t"<<customer[i].customName<<"\t\t"<<customer[j].medicine.ID<<"\t\t"<<customer[j].medicine.name<<"\t\t"<<customer[j].medicine.type;
	cout<<"\t\t" <<customer[j].medicine.price<<"\t\t"<<customer[j].medicine.quantity<<"\t\t"<<customer[i].receiptNo<<"\t\t"<<customer[i].orderdate.dd;
	cout<<"/"<<customer[i].orderdate.mm<<"/"<<customer[i].orderdate.yy<<"\t\t"<<sale;
	cout<<"TOTAL SALE-------------------------------------------------------------------------------------------------------------------------------";
		cout<<"-------------------------"<<total_sale;

}
